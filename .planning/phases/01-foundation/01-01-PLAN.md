---
phase: 01-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - pyproject.toml
  - src/openclawpack/__init__.py
  - src/openclawpack/_version.py
  - src/openclawpack/cli.py
  - src/openclawpack/output/__init__.py
  - src/openclawpack/output/schema.py
  - tests/__init__.py
  - tests/conftest.py
  - tests/test_output/__init__.py
  - tests/test_output/test_schema.py
autonomous: true
requirements:
  - PKG-01
  - PKG-02
  - PKG-03
  - PKG-04
  - OUT-01
  - OUT-02

must_haves:
  truths:
    - "Running `pip install -e .` installs the openclawpack package with CLI entry point"
    - "`openclawpack --version` prints version string without importing transport or Claude SDK"
    - "`openclawpack --help` shows CLI help text without Claude Code installed"
    - "CommandResult model serializes to JSON matching {success, result, errors, session_id, usage, duration_ms} schema"
    - "All output JSON validates against Pydantic model schema"
  artifacts:
    - path: "pyproject.toml"
      provides: "Package configuration with hatchling build backend"
      contains: "[project.scripts]"
    - path: "src/openclawpack/__init__.py"
      provides: "Package init with version re-export"
      contains: "__version__"
    - path: "src/openclawpack/_version.py"
      provides: "Single source of version truth"
      contains: "__version__"
    - path: "src/openclawpack/cli.py"
      provides: "Typer CLI with --version and --help"
      contains: "typer.Typer"
    - path: "src/openclawpack/output/schema.py"
      provides: "CommandResult standard output envelope"
      exports: ["CommandResult"]
  key_links:
    - from: "pyproject.toml"
      to: "src/openclawpack/cli.py"
      via: "[project.scripts] entry point"
      pattern: 'openclawpack = "openclawpack.cli:app"'
    - from: "src/openclawpack/cli.py"
      to: "src/openclawpack/_version.py"
      via: "lazy import in version_callback"
      pattern: "from openclawpack._version import __version__"
---

<objective>
Create the installable Python package skeleton with CLI entry point and standard JSON output schema.

Purpose: Establish the foundational project structure that all subsequent plans build upon. The package must be installable via pip, provide a working CLI binary, and define the output envelope used by every command.

Output: A pip-installable package with `openclawpack` CLI binary, `--version`/`--help` working without Claude Code, and `CommandResult` Pydantic model for standard JSON output.
</objective>

<execution_context>
@/Users/mit/.claude/get-shit-done/workflows/execute-plan.md
@/Users/mit/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-foundation/01-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create package skeleton with pyproject.toml and src layout</name>
  <files>
    pyproject.toml
    src/openclawpack/__init__.py
    src/openclawpack/_version.py
    src/openclawpack/transport/__init__.py
    src/openclawpack/state/__init__.py
    src/openclawpack/output/__init__.py
    tests/__init__.py
    tests/conftest.py
  </files>
  <action>
    Create the project structure using src/ layout (prevents test import confusion per research pitfall 5).

    **pyproject.toml:**
    - Build system: hatchling (`requires = ["hatchling"]`, `build-backend = "hatchling.build"`)
    - Project name: `openclawpack`, version: `0.1.0`
    - `requires-python = ">=3.10"`
    - Dependencies: `pydantic>=2.12`, `typer>=0.24`, `anyio>=4.8`, `claude-agent-sdk>=0.1.39`
    - Entry point: `[project.scripts] openclawpack = "openclawpack.cli:app"`
    - Dev dependencies: `pytest>=8.0`, `pytest-anyio>=0.0.0`, `ruff>=0.9`
    - Include `[tool.hatch.build.targets.wheel]` with `packages = ["src/openclawpack"]`

    **src/openclawpack/_version.py:**
    - Single line: `__version__ = "0.1.0"`

    **src/openclawpack/__init__.py:**
    - Import and re-export `__version__` from `_version.py`
    - Do NOT import transport, state, or output modules at top level

    **Sub-package __init__.py files:**
    - Create empty `__init__.py` files for `transport/`, `state/`, `output/` sub-packages
    - These are placeholders for subsequent plans

    **tests/conftest.py:**
    - Empty file with a docstring: `"""OpenClawPack test configuration."""`

    **tests/__init__.py:**
    - Empty init file
  </action>
  <verify>
    Run: `cd /Users/mit/Documents/GitHub/openclawpack && pip install -e ".[dev]"` -- must succeed.
    Run: `python -c "import openclawpack; print(openclawpack.__version__)"` -- must print `0.1.0`.
  </verify>
  <done>Package installs via pip. `import openclawpack` works and exposes `__version__`.</done>
</task>

<task type="auto">
  <name>Task 2: Create Typer CLI with --version and --help</name>
  <files>
    src/openclawpack/cli.py
  </files>
  <action>
    Create the CLI entry point using Typer. CRITICAL: Transport must NOT be imported at module level (PKG-04 -- --version and --help must work without Claude Code installed).

    **src/openclawpack/cli.py:**
    - Create `app = typer.Typer(name="openclawpack", help="AI agent control over GSD framework via Claude Code")`
    - Add `version_callback(value: bool)` that lazy-imports `__version__` from `openclawpack._version` and prints `openclawpack {version}`, then raises `typer.Exit()`
    - Add `@app.callback()` with `--version` option using `version_callback` as eager callback
    - Add a placeholder `status` command that prints `{"message": "not yet implemented"}` -- this will be implemented properly in Plan 02 (state parser). The placeholder ensures the CLI has at least one command for `--help` to display.
    - Do NOT import anything from `transport/` at module level
    - Do NOT import anything from `state/` at module level
    - Only import `typer` at module level
  </action>
  <verify>
    Run: `openclawpack --version` -- must print `openclawpack 0.1.0`.
    Run: `openclawpack --help` -- must show help text with "AI agent control over GSD framework" and the status command.
    Run: `python -c "import openclawpack.cli"` -- must NOT trigger any claude-agent-sdk imports (verify by checking no CLINotFoundError even if Claude is not on PATH).
  </verify>
  <done>`openclawpack --version` prints version. `openclawpack --help` shows help text. Neither requires Claude Code to be installed.</done>
</task>

<task type="auto">
  <name>Task 3: Create CommandResult output schema with tests</name>
  <files>
    src/openclawpack/output/schema.py
    src/openclawpack/output/__init__.py
    tests/test_output/__init__.py
    tests/test_output/test_schema.py
  </files>
  <action>
    Create the standard output envelope model that every command will use (OUT-01, OUT-02).

    **src/openclawpack/output/schema.py:**
    - Define `CommandResult(BaseModel)` with fields:
      - `success: bool`
      - `result: Any = None`
      - `errors: list[str] = Field(default_factory=list)`
      - `session_id: str | None = None`
      - `usage: dict[str, Any] | None = None`
      - `duration_ms: int = 0`
    - Add `to_json(self) -> str` method returning `self.model_dump_json(indent=2)`
    - Add `@classmethod def error(cls, message: str, duration_ms: int = 0) -> "CommandResult"` factory for error results
    - Add `@classmethod def ok(cls, result: Any, session_id: str | None = None, usage: dict | None = None, duration_ms: int = 0) -> "CommandResult"` factory for success results

    **src/openclawpack/output/__init__.py:**
    - Export `CommandResult` from schema module

    **tests/test_output/test_schema.py:**
    - Test `CommandResult` success case: `CommandResult.ok(result={"phase": 1})` has `success=True`, empty errors
    - Test `CommandResult` error case: `CommandResult.error("something broke")` has `success=False`, error in list
    - Test JSON serialization: `to_json()` returns valid JSON with all 6 top-level keys present
    - Test `model_json_schema()` produces valid JSON schema with all fields
    - Test round-trip: `CommandResult.model_validate_json(result.to_json())` reproduces original
  </action>
  <verify>
    Run: `cd /Users/mit/Documents/GitHub/openclawpack && python -m pytest tests/test_output/ -v` -- all tests pass.
    Run: `python -c "from openclawpack.output import CommandResult; r = CommandResult.ok({'test': True}); print(r.to_json())"` -- prints valid JSON with all 6 fields.
  </verify>
  <done>CommandResult model validates, serializes to JSON with {success, result, errors, session_id, usage, duration_ms}, and all tests pass.</done>
</task>

</tasks>

<verification>
1. `pip install -e ".[dev]"` succeeds
2. `openclawpack --version` outputs `openclawpack 0.1.0`
3. `openclawpack --help` shows help with description and status command
4. `python -m pytest tests/ -v` -- all output schema tests pass
5. `python -c "from openclawpack.output import CommandResult; print(CommandResult.model_json_schema())"` -- prints valid JSON schema
</verification>

<success_criteria>
- Package installs via pip with `openclawpack` binary on PATH
- `--version` and `--help` work without Claude Code on PATH
- CommandResult model has all 6 required fields and serializes correctly
- All tests pass
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-01-SUMMARY.md`
</output>
